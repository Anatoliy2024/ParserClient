<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Парсин сайт</title>
    <link type="Image/x-icon" href="/favicon.ico" rel="icon" />
    <!-- <link rel="stylesheet" href="/global.css" /> -->
  </head>
  <body style="padding: 20px; margin: 0; background-image: url('/3.png')">
    <div
      style="
        padding: 20px;
        color: rgb(229, 190, 255);
        max-width: 1000px;
        margin: auto;
        border-radius: 20px;
        background: rgba(0, 0, 0, 0.8);
        display: flex;
        justify-content: center;
      "
    >
      <div>
        <table>
          <caption style="font-size: xx-large">
            Парсин сайта https://glazahelp.ru/
          </caption>
          <thead>
            <tr>
              <th scope="col">Ссылка на сайт</th>
              <th scope="col">Город</th>
              <th scope="col">Адрес клиники</th>
            </tr>
          </thead>
          <tbody class="table"></tbody>
        </table>
      </div>
    </div>
    <script>
      // fetch("https://parser-server.vercel.app/api/clinic")
      //   .then((response) => {
      //     if (!response.ok) {
      //       throw new Error("Network response was not ok")
      //     }
      //     return response.json()
      //   })
      //   .then((clinics) => {
      //     const table = document.querySelector(".table")
      //     table.innerHTML = ""

      //     clinics.forEach((clinic) => {
      //       const row = document.createElement("tr")
      //       row.innerHTML = `<td><a href="${clinic[0]}" style="color: rgb(201, 119, 255);">${clinic[0]}</a></td><td>${clinic[1]}</td><td>${clinic[2]}</td>`
      //       table.appendChild(row)
      //     })
      //   })
      //   .catch((err) => console.error("Error:", err))

      const eventSource = new EventSource(
        "https://parser-server.vercel.app/api/clinic"
      )

      eventSource.onmessage = function (event) {
        const data = JSON.parse(event.data)
        console.log("Полученные данные:", data)

        // Обновляем вашу таблицу или другой интерфейс
        const table = document.querySelector(".table")
        const row = document.createElement("tr")
        row.innerHTML = `<td><a href="${data.link}" style="color: rgb(201, 119, 255);">${data.link}</a></td><td>${data.city}</td><td>${data.address}</td>`
        table.appendChild(row)
      }

      eventSource.onerror = function (error) {
        console.error("Ошибка:", error)
      }
    </script>
  </body>
</html>
